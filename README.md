# JHosting
Компонент управления хостингом для Joomla 5.x-6.x

## Описание

JHosting - это полнофункциональный компонент для управления хостинг-услугами в Joomla. Компонент предоставляет личный кабинет пользователя с возможностью управления услугами, оплаты, просмотра истории транзакций и работы с технической поддержкой.

## Основные возможности

### Для клиентов:
- Личный кабинет с современным дизайном в стиле 2DOMAINS
- Управление балансом и пополнение через Robokassa
- Просмотр и управление услугами (хостинг, домены, SSL)
- История платежей и транзакций
- Система обращений в техподдержку
- Управление профилями для регистрации доменов
- Настройки безопасности аккаунта

### Для администраторов:
- Панель управления в админке Joomla
- Управление пользователями и их балансами
- Управление услугами и серверами
- Интеграция с ISPmanager 6 через REST API
- Автоматическая приостановка/возобновление услуг
- Генерация счетов для юридических лиц
- Система тикетов техподдержки

## Технические требования

- Joomla 5.1+ (совместимость с 6.x)
- PHP 8.2+
- PostgreSQL 12+
- Composer для управления зависимостями

## Зависимости

- GuzzleHttp/Guzzle - для HTTP-запросов к внешним API
- PhpOffice/PhpWord - для генерации документов
- Tecnickcom/TCPDF - для генерации PDF
- Firebase/PHP-JWT - для работы с JWT токенами

## Установка

1. Скачайте пакет `pkg_hosting.zip`
2. Установите через менеджер расширений Joomla
3. Настройте параметры компонента в админке
4. Настройте интеграцию с ISPmanager и Robokassa

## Настройка

### Основные настройки:
- URL ISPmanager панели
- Тип авторизации (сессия/API ключ)
- Валюта по умолчанию
- Автоматическая приостановка услуг

### Настройки платежей:
- Логин и пароли Robokassa
- Тестовый режим
- Комиссии и лимиты

### Юридические данные:
- Реквизиты компании
- Шаблоны договоров
- Настройки для генерации счетов

## Структура базы данных

Компонент создает следующие таблицы:
- `#__hosting_users` - пользователи хостинга
- `#__hosting_services` - услуги
- `#__hosting_domains` - домены
- `#__hosting_transactions` - транзакции
- `#__hosting_invoices` - счета
- `#__hosting_tickets` - тикеты поддержки
- `#__hosting_ticket_messages` - сообщения тикетов
- `#__hosting_user_settings` - настройки пользователей
- `#__hosting_cron_jobs` - задания cron

## API интеграции

### ISPmanager 6
Компонент поддерживает интеграцию с ISPmanager 6 через REST API:
- Создание/удаление аккаунтов
- Приостановка/возобновление услуг
- Получение статистики использования
- Управление доменами и поддоменами

### Robokassa
Интеграция с платежной системой Robokassa:
- Создание платежных ссылок
- Обработка уведомлений о платежах
- Проверка статуса платежей
- Расчет комиссий

## Безопасность

- Изоляция учетных записей Joomla от ISPmanager
- JWT токены для API с коротким временем жизни
- AES-256 шифрование для хранения секретов
- Rate limiting для предотвращения атак
- CSRF защита для всех форм
- Валидация и санитизация всех входных данных

## Разработка

### Структура проекта:
```
pkg_hosting/
├── com_hosting/           # Основной компонент
│   ├── administrator/     # Админка
│   ├── site/             # Фронтенд
│   ├── src/              # Исходный код
│   ├── tmpl/             # Шаблоны
│   ├── media/            # CSS/JS/изображения
│   └── language/         # Языковые файлы
├── libraries/hosting/     # Библиотеки и сервисы
├── sql/                  # SQL скрипты
└── composer.json         # Зависимости
```

### Расширение функционала:
Компонент построен с использованием интерфейсов, что позволяет легко добавлять поддержку новых панелей управления:
- Реализуйте `HostingPanelInterface`
- Добавьте новый сервис в `libraries/hosting/Services/`
- Обновите конфигурацию компонента

## Лицензия

GNU General Public License version 2 or later

## Поддержка

- Email: info@rameva.ru
- Telegram: @rameva_support
- Сайт: https://rameva.ru

## Changelog

### v1.0.0 (2025-01-XX)
- Первый релиз
- Базовый функционал личного кабинета
- Интеграция с ISPmanager 6
- Интеграция с Robokassa
- Система тикетов
- Управление доменами (read-only)
- Генерация счетов для юрлиц